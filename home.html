<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>PAF X â€” Discussions</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#0b0b0b;
  font-family:system-ui,-apple-system;
  color:#fff;
}

/* TOP BAR */
.top{
  height:56px;
  background:#141414;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 14px;
  border-bottom:1px solid #1f1f1f;
}
.top-left{
  display:flex;
  align-items:center;
  gap:10px;
}
.logo{
  width:28px;
}
.title{
  font-weight:600;
}
.avatar{
  width:36px;
  height:36px;
  border-radius:50%;
  object-fit:cover;
  cursor:pointer;
}

/* CHAT LIST */
.chat{
  display:flex;
  padding:12px 14px;
  align-items:center;
}
.chat:hover{background:#1a1a1a}

.chat-avatar{
  width:52px;
  height:52px;
  border-radius:50%;
  margin-right:12px;
  object-fit:cover;
}

.chat-body{
  flex:1;
  border-bottom:1px solid #1f1f1f;
  padding-bottom:10px;
}

.row{
  display:flex;
  justify-content:space-between;
}

.name{font-weight:600}
.time{font-size:12px;color:#aaa}

.last{
  font-size:14px;
  color:#aaa;
}

/* PROFILE PANEL */
#profile{
  position:fixed;
  inset:0;
  background:#0b0b0b;
  display:none;
  padding:24px;
}

#profile img{
  width:96px;
  height:96px;
  border-radius:50%;
  display:block;
  margin:20px auto;
}

.profile-item{
  margin-top:16px;
  color:#ccc;
  text-align:center;
}

/* FAB */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:#e50914;
  color:#fff;
  font-size:26px;
  border:none;
}
</style>
</head>

<body>

<!-- TOP -->
<div class="top">
  <div class="top-left">
    <img src="logo.png" class="logo">
    <div class="title">PAF X</div>
  </div>
  <img id="avatarTop" class="avatar">
</div>

<!-- CHAT LIST -->
<div class="chat">
  <img class="chat-avatar" src="https://i.pravatar.cc/150?img=12">
  <div class="chat-body">
    <div class="row">
      <div class="name">PAF STREAM</div>
      <div class="time">08:12</div>
    </div>
    <div class="last">Bienvenue sur PAF X ðŸŽ‰</div>
  </div>
</div>

<button class="fab">ï¼‹</button>

<!-- PROFILE -->
<div id="profile">
  <img id="profileImg">
  <div class="profile-item" id="pName"></div>
  <div class="profile-item" id="pEmail"></div>
  <div class="profile-item" id="pPhone"></div>

  <button onclick="closeProfile()" style="margin-top:30px">Fermer</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyCAsEnTrE0EvR0ZwbS_YpF3a4Ph3S3VHZQ",
  authDomain: "paf-x-56f2d.firebaseapp.com",
  projectId: "paf-x-56f2d",
  storageBucket: "paf-x-56f2d.firebasestorage.app",
  messagingSenderId: "1023059500240",
  appId: "1:1023059500240:web:9d3a646b52f510cbd512d5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* AUTH CHECK */
onAuthStateChanged(auth, async (user)=>{
  if(!user){
    window.location.href="index.html";
    return;
  }

  const snap = await getDoc(doc(db,"users",user.email));
  if(!snap.exists()) return;

  const data = snap.data();

  avatarTop.src = user.photoURL || "https://i.pravatar.cc/150";
  profileImg.src = avatarTop.src;

  pName.textContent = data.prenom+" "+data.nom;
  pEmail.textContent = data.email;
  pPhone.textContent = data.phone;
});

/* PROFILE */
avatarTop.onclick=()=>{
  profile.style.display="block";
}
window.closeProfile=()=>{
  profile.style.display="none";
}
</script>

</body>
</html>
